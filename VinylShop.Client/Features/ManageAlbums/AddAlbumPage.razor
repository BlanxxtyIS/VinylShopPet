@page "/add-album"

<PageTitle>Add Album - Vinyl Shop</PageTitle>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Home</a></li>
        <li class="breadcrumb-item active" aria-current="page">Add Album</li>
    </ol>
</nav>

<h3 class="mt-5 mb-4">Add a album</h3>

<EditForm Model="_album" OnValidSubmit="SubmitForm">
    <FormSection Title="Basic Details"
        HelpText="This information is used to identity the album and can be searched to help hikers find it.">

        <FormFieldSet Width="col-6">
            <label for="albumName" class="font-weight-bold
                text-secondary">Name</label>
            <InputText @bind-Value="_album.Name" class="form-control" id="albumName" />
        </FormFieldSet>

        <FormFieldSet>
            <label for="albumDescription"
                   class="font-weight-bold text-secondary">Description</label>
            <InputTextArea @bind-Value="_album.Description" rows="6"
                           class="form-control" id="albumDescription" />
        </FormFieldSet>

        <FormFieldSet Width="col-6">
            <label for="albumAuthorName"
                   class="font-weight-bold text-secondary">Author Name</label>
            <InputTextArea @bind-Value="_album.AuthorName" class="form-control"
                   id="albumAuthorName" />
        </FormFieldSet>

        <div class="row">
            <div class="col-6">
                <div class="form-group">
                    <label for="albumAuthorName"
                           class="font-weight-bold text-secondary">Rating</label>
                    <InputText @bind-Value="_album.AuthorName" class="form-control" id="albumAuthorName" />
                </div>
            </div>
        </div>
    </FormSection>

    <FormSection Title="Difficulty"
        HelpText="">
        <FormFieldSet Width="col-3">
            <label for="albumRating"
                class="font-weight-bold text-secondary">Rating (stars)</label>
                <InputNumber @bind-Value="_album.Rating"
                    class="form-control" id="albumRating"/>
        </FormFieldSet>
    </FormSection>

    <div class="mt-4 mb-5">
        <div class="row">
            <div class="offset-4 col-8 text-right">
                <button class="btn btn-outline-secondary"
                        type="button"
                        @onclick="@(() => _album = new AlbumDTO())">
                    Reset
                </button>
                <button class="btn btn-primary"
                        type="submit">
                    Submit
                </button>
            </div>
        </div>
    </div>

    <FormSection Title="Route Instructions"
        HelpText="Route instructions are a guide for the album. This helps hikers new to the album stay on track.">
        @{
            var i = 0; 
        }
        @foreach (var song in _album.Songs)
        {
            i++;
            song.AlbumId = i;

            <div class="row">
                <div class="col-2">
                    <div class="form-group">
                        <label class="font-weight-bold text-secondary">
                            AlbumId
                        </label>
                        <p>@song.AlbumId</p>
                    </div>
                </div>
                <div class="col">
                    <div class="form-group">
                        <label for="songDescription" class="font-weight-bold text-secondary">Description</label>
                        <InputText @bind-Value="song.Text" class="form-control" id="songDescription" />
                    </div>
                </div>
                <div class="col-1 d-flex mt-3">
                    <button @onclick="(() => _album.Songs.Remove(song))"
                        class="btn btn-link" type="button">
                        <svg width="1em" height="1em" viewBox="0 0 16 16"
                            class="bi bi-x-circle-fill text-danger"
                            fill="currentColor"
                            xmls="http://www.w3.org/2000/svg">
                        </svg>
                        </button>
                </div>
            </div>
        }

        <div class="row">
            <div class="col">
                <button class="btn btn-outline-primary"
                        type="button"
                        @onclick="@(() => _album.Songs.Add(new AlbumDTO.Song()))">
                    Add Song
                </button>
            </div>
        </div>
    </FormSection>
</EditForm>

@code {
    private AlbumDTO _album = new AlbumDTO();

    private async Task SubmitForm()
    {
        int i = 1;
    }
}